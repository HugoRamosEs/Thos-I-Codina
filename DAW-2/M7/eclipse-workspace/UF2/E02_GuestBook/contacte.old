<?php

    if (isset($_COOKIE["lang"])) {
        $lang = $_COOKIE["lang"];
    } else {
        $lang = "ca";
    }


$fitxerDeTraduccions = "languages/".$lang."_traduccio.php";
require_once $fitxerDeTraduccions;

$html_opacityLang[$lang]="style=\"opacity:1;\"";

if ($_SERVER["REQUEST_METHOD"]=="POST" && (isset($_POST["boto"]))) {
    $frmNom = sanitize($_POST["nom"],4);
    //$frmNom=$_POST["nom"];
    $frmMail = sanitize($_POST["email"],1);
    $frmMsg = sanitize($_POST["missatge"],3);
    
    if (strlen($frmNom)==0) {
        $errors["nom"] = "Has d'informar un nom";
    }
    if (!filter_var($frmMail, FILTER_VALIDATE_EMAIL)) {
        $errors["mail"] = "L'adreça de correu no és vàlida";
    }
    if (strlen($frmMsg)==0) {
        $errors["missatge"] = "Has d'escriure el comentari que vols enviar";
    }
    
    if (!isset($errors)) {
        $sData = getdate();
        $frmData = $sData['mday']."/".$sData['mon']."/".$sData['year'];
        $contacte = new Contact($frmNom, $frmMail, $frmMsg, $frmData );
        
        $mContacte = new ContactModel();
        $mContacte->create($contacte);
           
        unset($frmNom);
        unset($frmMail);
        unset($frmMsg);
        $missatgeOK="El comentari s'ha enviat correctament";
        
    }
}

?>


<!DOCTYPE html>
<html lang="en">
<?php include "templates/head.tpl.php";?>
<body>
	<?php include "templates/header.tpl.php";?>
	<?php include "templates/info_contact.tpl.php";?>
	<?php include "templates/footer.tpl.php";?>
</body>
</html>


